<!doctype html><meta charset="utf-8">
<title>Ascentrix Chat</title>
<style>
body { font-family: system-ui; background: #111; color: #eee; padding: 20px; }
#chatbox { width: 100%; height: 300px; overflow-y: auto; border: 1px solid #333; padding: 10px; margin-bottom: 10px; }
#inputbox { width: 100%; padding: 10px; }
</style>
<h1>Ascentrix Chat</h1>
<div id="chatbox"></div>
<input id="inputbox" placeholder="Type a message and hit Enter...">

<script>
const chatbox = document.getElementById("chatbox");
const input = document.getElementById("inputbox");

function append(text, from="user") {
  const msg = document.createElement("div");
  msg.textContent = `${from === "user" ? "You" : "AI"}: ${text}`;
  chatbox.appendChild(msg);
  chatbox.scrollTop = chatbox.scrollHeight;
}

input.addEventListener("keydown", async e => {
  if (e.key === "Enter") {
    const text = input.value.trim();
    if (!text) return;
    append(text, "user");
    input.value = "";
    const res = await fetch("http://127.0.0.1:5051/task", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ data: text })
    }).then(r => r.json());

    setTimeout(async () => {
      const out = await fetch(`http://127.0.0.1:5051/result/${res.job_id}`).then(r => r.json());
      append(out.result?.data || JSON.stringify(out), "ai");
    }, 3000);
  }
});
</script>
